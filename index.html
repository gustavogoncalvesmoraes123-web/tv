<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Minha TV Linux</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@0.14.17"></script>
    <style>
        body { background: #000; color: #fff; font-family: Arial, sans-serif; margin: 0; padding: 0; }
        #player-fixo { position: sticky; top: 0; width: 100%; background: #000; border-bottom: 2px solid red; z-index: 999; }
        video { width: 100%; height: 200px; background: #111; }
        .lista { padding: 10px; }
        .canal { 
            display: block; width: 100%; padding: 15px; margin-bottom: 8px;
            background: #222; color: #fff; border: 1px solid #444; border-radius: 5px;
            text-align: left; font-size: 18px; text-decoration: none;
        }
        .canal:active { background: red; }
        #status { font-size: 12px; color: yellow; margin: 5px; }
    </style>
</head>
<body>

<div id="player-fixo">
    <video id="video" controls autoplay playsinline></video>
    <div id="status">Selecione um canal...</div>
</div>

<div class="lista" id="listaCanais">Carregando lista...</div>

<script>
    var video = document.getElementById('video');
    var statusTxt = document.getElementById('status');
    
    // 1. SUA LISTA AQUI (Adicionei o proxy para evitar o "carregando" eterno)
    var minhaListaM3U = 'https://raw.githubusercontent.com/Ramys/Iptv-Brasil-2026/refs/heads/master/CanaisBR%20-%20Completo.m3u8'; 
    var urlFinal = 'https://corsproxy.io/?' + encodeURIComponent(minhaListaM3U);

    function darPlay(url, nome) {
        statusTxt.innerText = "Conectando: " + nome;
        
        // Adiciona proxy no link do canal também (ajuda muito em TVs antigas)
        var linkComProxy = 'https://corsproxy.io/?' + encodeURIComponent(url);

        if (Hls.isSupported()) {
            var hls = new Hls();
            hls.loadSource(linkComProxy);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, function() {
                video.play();
                statusTxt.innerText = "Passando: " + nome;
            });
        } 
        else if (video.canPlayType('application/vnd.apple.mpegurl')) {
            // Caso a TV tenha suporte nativo (comum em algumas Linux/Opera)
            video.src = linkComProxy;
            video.play();
        }
    }

    // Carregamento da lista usando método antigo (AJAX) para maior compatibilidade
    var xhr = new XMLHttpRequest();
    xhr.open('GET', urlFinal, true);
    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4 && xhr.status == 200) {
            var data = xhr.responseText;
            var linhas = data.split('\n');
            var botoes = '';
            for (var i = 0; i < linhas.length; i++) {
                if (linhas[i].indexOf('#EXTINF:') !== -1) {
                    var nome = linhas[i].split(',')[1] || "Canal";
                    var link = linhas[i + 1].trim();
                    botoes += '<button class="canal" onclick="darPlay(\''+link+'\', \''+nome+'\')">' + nome + '</button>';
                }
            }
            document.getElementById('listaCanais').innerHTML = botoes;
        }
    };
    xhr.send();
</script>

</body>
</html>
